[gcode_macro LOAD_PROMPT]
gcode:
  {% set materials = printer['gcode_macro _TEMP_VARIABLES'].materials %}
  RESPOND TYPE=command MSG="action:prompt_begin Preheat for Load"
  RESPOND TYPE=command MSG="action:prompt_text Insert filament and choose a material"
  RESPOND TYPE=command MSG="action:prompt_button_group_start"
  {% for idx in range(0, materials|length) %}
    {% set s = "action:prompt_button " + materials[idx][0] + ' - ' + materials[idx][1]|string + '/' + materials[idx][3]|string + "|LOAD_FILAMENT INDEX='" + idx|string + "'" %} # Thank you Aubey!
    RESPOND TYPE=command MSG="{s}"
  {% endfor %}
  RESPOND TYPE=command MSG="action:prompt_button_group_end"
  RESPOND TYPE=command MSG="action:prompt_show"
